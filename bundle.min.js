$(function(){$("#register").click(function(){e("#name")&&e("#telephone")&&e("#pwd")&&e("#code")});var t,l,n,r=[!0,!0,!0];function e(e){var t=e;$(t+"-msg").html("");for(var l=0;l<r.length;l++)$("#sp"+l).html("");switch(t){case"#name":a("用户名",t);break;case"#telephone":c("手机号",t);break;case"#pwd":s("密码",t);break;case"#code":u("验证码",t);break;default:return}return 1}function a(e,t){if(""===$(t).val())return $(t+"-msg").html(e+"不能为空"),null;if(!/^(?!(\d+)$)[\u4e00-\u9fff\w]+$/.test($(t).val()))return $(t+"-msg").html("用户名仅支持中英文、数字和下划线且不能为纯数字"),!1;var l=$(t).val().match(/[\u4E00-\u9FA5]/g),n=$(t).val().length;return 14<2*(l=null===l?0:l.length)+n-l||7<l?($(t+"-msg").html("用户名不能超过7个汉字或14个字符"),!1):void 0}function c(e,t){return""===$(t).val()?($(t+"-msg").html(e+"不能为空"),null):/^[1][3,4,5,7,8][0-9]{9}$/.test($(t).val())?void 0:($(t+"-msg").html("手机号码格式不正确"),!1)}function s(e,t){if(""===$(t).val())return $(t+"-msg").html(e+"不能为空"),null;for(var l=$(t).val().match(/[\u4E00-\u9FA5]/g),n=$(t).val().length,a=void 0,c=2*(l=null===l?0:l.length)+n-l,s=0;s<r.length;s++)switch(s){case 0:(c<8||14<c)&&(r[0]=!1,$(t+"-msg").html("密码设置不符合要求"),a=!1);break;case 1:/(?!^(\d+|[a-zA-Z]+|[~!@#$%^&*?]+)$)^[\w~!@#$%^&*?]{1,14}$/.test($(t).val().replace(/\s/g,"").replace(/[\u4e00-\u9fa5]/g,""))||(r[1]=!1,$(t+"-msg").html("密码设置不符合要求"),a=!1);break;case 2:(-1<$(t).val().indexOf(" ")||null!==$(t).val().match(/[\u4E00-\u9FA5]/g))&&(r[2]=!1,$(t+"-msg").html("密码设置不符合要求"),a=!1);break;default:return}for(s=0;s<r.length;s++)if(r[s])switch(s){case 0:case 1:case 2:$("#sp"+s).html("✓");break;default:return}else switch(s){case 0:case 1:case 2:$("#sp"+s).html("x");break;default:return}return a}function u(e,t){if(""===$(t).val())return $(t+"-msg").html(e+"不能为空"),null}function o(e,t,l){$(t).focusout(function(){"#pwd"===t&&$("#fl-pwd").css("display","none"),""!==$(t).val()&&!1===l(e,t)?$(t).select():$(t+"-msg").html("")})}$("#code-btn").click(function(){var e=25;$("#code-msg").html("");var t=setInterval(function(){--e,$("#code-btn").attr("value",e),0===e?($("#code-msg").html("请求超时,请稍后再试"),$("#code-btn").attr("value","获取验证码"),e=25,$("#code-btn").attr("disabled",!1),$("#code-btn").css("cursor","pointer"),clearInterval(t)):($("#code-btn").attr("disabled",!0),$("#code-btn").css("cursor","not-allowed"))},1e3)}),o("用户名","#name",a),o("手机号","#telephone",c),o("验证码","#code",u),o("密码","#pwd",s),t="密码",l="#pwd",n=s,$(l).bind("input propertychange",function(){if(""===$(l).val())for(var e=0;e<r.length;e++)$("#sp"+e).html("");else{for(e=0;e<r.length;e++)r[e]=!0;n(t,l)}})}),$("#name").focus(function(){$("#fl-div").css("display","block")}).focusout(function(){$("#fl-div").css("display","none")}),$("#pwd").focus(function(){$("#fl-pwd").css("display","block")});